define("formCommon",["lodash","coreUtils","santa-components","componentsCore","prop-types","reactDOM","santa-core-utils"],(function(e,t,i,s,o,n,r){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,function(t){return e[t]}.bind(null,o));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=763)}({0:function(t,i){t.exports=e},1:function(e,i){e.exports=t},10:function(e,t){e.exports=r},2:function(e,t){e.exports=i},3:function(e,t){e.exports=s},4:function(e,t){e.exports=o},6:function(e,t){e.exports=n},763:function(e,t,i){var s,o;s=[i(764)],void 0===(o=function(e){"use strict";return{formMixin:e}}.apply(t,s))||(e.exports=o)},764:function(e,t,i){var s,o;s=[i(0),i(2),i(10),i(3),i(1),i(765),i(767),i(6),i(4)],void 0===(o=function(e,t,i,s,o,n,r,a,p){"use strict";function c(){return"SubscribeFormActivity"===this.getActivityName()}function d(){var e=this.props.compData.successMessage||this.translatedKeys.successMessage;this.showMessage(e)}function u(){var t=this.props.compData.link;if(t){var i=o.linkRenderer.renderLink(t,this.props.linkRenderInfo,this.props.rootNavigationInfo),s=o.wixUrlParser.parseUrl(this.props.linkRenderInfo,o.linkRenderer.getLinkUrlFromLinkProps(i));if(s){var n=t.anchorDataId;e.assign(s,{anchorData:n}),s.pageId===this.props.rootNavigationInfo.pageId?n&&this.props.scrollToAnchor(n):this.props.navigateToPage(s)}}}function m(e,t){return(e||[]).reduce((function(e,i){return i[t]?e+1:e}),0)}function l(t){var i,s=this,n=t.includeEmail,r=t.onSuccess,a=t.onError,p=this.props.compData,d=p.toEmailAddress,u=p.bccEmailAddress,m=p.formName,l=this.getFieldsForActivityReporting(),f={to:[{address:d||"",name:d||""}]},h=u?{bcc:[{address:u,name:u}]}:{},y=n?{editorMetaData:{siteId:this.props.siteId,pageId:this.props.pageId,compDataId:this.props.compData.id}}:{},I=c.call(this)?["SUBSCRIBE"]:[];o.ajaxLibrary.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"".concat(this.props.activityInfo.baseUrl,"/").concat("_api/wix-forms/v1/submit-contact-form"),headers:{Authorization:(i=s.props.getClientSpecMapEntry(-666),e.get(i,"instance")),"x-wix-site-revision":this.props.siteRevision},data:e.merge({fields:l,formName:m||"",types:I},f,h,y),success:r,error:a})}function f(){o.integrations.promoteAnalytics.trackEvent(this.props.siteApiForPromoteAnalytics,"Lead"),this.props.reportBI(r.FORM_SUBMIT_SUCCESS,{componentId:this.props.id,componentType:this.props.structure.componentType}),this.setState({mailSent:!0}),"message"===this.props.compData.onSubmitBehavior?d.call(this):u.call(this),y.call(this),this.isBusy=!1}function h(e){this.props.reportBI(n.FORM_SUBMIT_FINAL_FALLBACK,{componentId:this.props.id,componentType:this.props.structure.componentType,errorDesc:"Error occurred in Fallback Request",response:JSON.stringify(e)}),this.setState({mailSent:!1}),this.showMessage(this.translatedKeys.error,!0),this.isBusy=!1}function y(){this.setState(this.getCleanFormState())}function I(e){if(e.preventDefault(),this.shouldBlockSubmit&&this.shouldBlockSubmit())this.blockSubmit(a.findDOMNode(this));else{T.call(this,r.CONTACT_FORM_CLICK_SUBMIT,{isDynamic:this.props.isDynamicContactForm});var t=this.props.compData.toEmailAddress;t&&"a33012eff368a577d48f52f310c92140"!==t||this.props.reportBI(n.FORM_SUBMIT_INVALID_EMAIL,{email:t});var i,s={isDynamic:this.props.isDynamicContactForm,numOfFields:m(this.props.orderedFields,"hidden"),numOfRequiredFields:m(this.props.orderedFields,"required")},o=this.isFormValid();!this.isBusy&&o&&!((i=this.props).ignoreActivityReport||i.isTemplate)?(this.props.reportBI(r.FORM_SUBMIT,{componentId:this.props.id,componentType:this.props.structure.componentType}),T.call(this,r.CONTACT_FORM_SUBMIT_VALIDATION_SUCCESS,s),this.shouldSubmitFallbackRequest=!0,this.isBusy=!0,"message"===this.props.compData.onSubmitBehavior&&this.showMessage(this.translatedKeys.submitting),l.call(this,{includeEmail:!0,onSuccess:f.bind(this),onError:h.bind(this)})):o||T.call(this,r.CONTACT_FORM_SUBMIT_VALIDATION_FAILURE,s)}}function T(t,i){this.props.biVisitorId&&this.props.reportBI(t,e.merge(i,{visitorId:this.props.biVisitorId}))}return{mixins:[s.mixins.skinBasedComp,i.timersMixins.timeoutsMixin],propTypes:{compMasterPageData:t.santaTypesDefinitions.ContactFormSantaTypes.compMasterPageData,siteApiForPromoteAnalytics:t.santaTypesDefinitions.ContactFormSantaTypes.siteApiForPromoteAnalytics,id:t.santaTypesDefinitions.Component.id.isRequired,pageId:t.santaTypesDefinitions.Component.pageId.isRequired,siteId:t.santaTypesDefinitions.RendererModel.siteId.isRequired,structure:t.santaTypesDefinitions.Component.structure.isRequired,compData:t.santaTypesDefinitions.Component.compData.isRequired,rootNavigationInfo:t.santaTypesDefinitions.Component.rootNavigationInfo.isRequired,shouldResetComponent:t.santaTypesDefinitions.RenderFlags.shouldResetComponent.isRequired,contactFormTranslations:t.santaTypesDefinitions.ContactFormSantaTypes.contactFormTranslations.isRequired,isMobileView:t.santaTypesDefinitions.isMobileView.isRequired,isPremiumUser:t.santaTypesDefinitions.isPremiumUser.isRequired,isTemplate:t.santaTypesDefinitions.isTemplate.isRequired,metaSiteId:t.santaTypesDefinitions.RendererModel.metaSiteId.isRequired,externalBaseUrl:t.santaTypesDefinitions.PublicModel.externalBaseUrl,scrollToAnchor:t.santaTypesDefinitions.scrollToAnchor.isRequired,navigateToPage:t.santaTypesDefinitions.navigateToPage.isRequired,reportBI:t.santaTypesDefinitions.reportBI.isRequired,linkRenderInfo:t.santaTypesDefinitions.Link.renderInfo.isRequired,activityInfo:t.santaTypesDefinitions.Activity.activityInfo,ignoreActivityReport:p.bool,isDynamicContactForm:t.santaTypesDefinitions.ContactFormSantaTypes.isDynamicContactForm.isRequired,userLanguage:t.santaTypesDefinitions.WixUserSantaTypes.userLanguage.isRequired,biVisitorId:t.santaTypesDefinitions.biVisitorId,siteRevision:t.santaTypesDefinitions.PublicModel.siteRevision,getClientSpecMapEntry:t.santaTypesDefinitions.getClientSpecMapEntry.isRequired},getInitialState:function(){return this.shouldResetFields=this.props.shouldResetComponent,this.translatedKeys=this.getLangKeys(this.props.contactFormTranslations),this.translatedKeys.submitting="â€¦",e.merge(this.getFormInitialState(),{$mob:this.props.isMobileView?"mobile":"desktop",$dir:this.props.compData.textDirection||"left"})},showMessage:function(e,t){this.setState({notifications:{message:e,error:!!t}})},componentWillReceiveProps:function(e){var t=e.shouldResetComponent;t&&t!==this.shouldResetFields&&y.call(this),this.shouldResetFields=t,this.setState({$mob:e.isMobileView?"mobile":"desktop",$dir:e.compData.textDirection||"left"})},getSkinProperties:function(){return this.state.notifications.message&&this.registerReLayout(),e.merge(this.getFormSkinProperties(this.translatedKeys),{submit:{onClick:I.bind(this),children:this.props.compData.submitButtonLabel||"Send"}})}}}.apply(t,s))||(e.exports=o)},765:function(e,t,i){var s,o;s=[i(766),i(0),i(1)],void 0===(o=function(e,t,i){"use strict";return t.forEach(e,(function(e,t){e.errorName=t})),i.loggingUtils.logger.register("forms","error",e),e}.apply(t,s))||(e.exports=o)},766:function(e){e.exports=JSON.parse('{"FORM_SUBMIT_FAILURE":{"errorCode":101027,"severity":"error","params":{"p1":"componentId","p2":"componentType","p3":"errorDesc","p4":"response"}},"FORM_SUBMIT_FINAL_FALLBACK":{"errorCode":101028,"severity":"fatal","params":{"p1":"componentId","p2":"componentType","p3":"errorDesc","p4":"response"}},"FORM_SUBMIT_INVALID_EMAIL":{"errorCode":101029,"severity":"error","params":{"p1":"email"}}}')},767:function(e,t,i){var s,o;s=[i(768)],void 0===(o=function(e){"use strict";return e}.apply(t,s))||(e.exports=o)},768:function(e){e.exports=JSON.parse('{"FORM_SUBMIT":{"eventId":100,"adapter":"ugc-viewer","params":{"c1":"componentId","c2":"componentType"}},"FORM_SUBMIT_SUCCESS":{"eventId":367,"adapter":"ugc-viewer","params":{"component_id":"componentId","component_type":"componentType"}},"CONTACT_FORM_CLICK_SUBMIT":{"eventId":712,"adapter":"contact-form","src":5,"params":{"is_dynamic":"isDynamic","visitor_id":"visitorId"}},"CONTACT_FORM_SUBMIT_VALIDATION_SUCCESS":{"eventId":713,"adapter":"contact-form","src":5,"params":{"is_dynamic":"isDynamic","num_of_required_fields":"numOfRequiredFields","num_of_fields":"numOfFields","visitor_id":"visitorId"}},"CONTACT_FORM_SUBMIT_VALIDATION_FAILURE":{"eventId":714,"adapter":"contact-form","src":5,"params":{"is_dynamic":"isDynamic","num_of_required_fields":"numOfRequiredFields","num_of_fields":"numOfFields","visitor_id":"visitorId"}}}')}})}));
//# sourceMappingURL=formCommon.min.js.map